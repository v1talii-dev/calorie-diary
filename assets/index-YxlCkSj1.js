import{c as he,g as Mt,_ as Dt,a as Ee,r as p,b as tn,d as at,e as J,f as nn,h as Ft,i as rn,R as c,m as B,w as A,j as M,u as ue,k as Ze,l as P,n as on,o as Lt,p as xe,q as oe,t as sn,S as Pt,s as At,v as an,x as ln,y as Ue,M as cn,z as un,A as lt,B as dn,C as Bt,D as fn,E as mn,F as hn,G as y,H as q,I as de,J as ke,K as vn,L as gn,N as pn,O as yn,P as bn,Q as Wt,T as qt}from"./index-CKqvEcJe.js";import{u as _n,S as ee,P as Cn}from"./pull-to-refresh-BOIhaAEy.js";import{g as fe,E as ie,S as Vt}from"./search-Vbi4HlCe.js";import{b as En,u as wn}from"./firebaseUserService-DqoBFBLB.js";import{u as xn,g as ct,a as kn,b as Sn,c as zt,B as se,d as Qe,I as Ge,L as z,F as H}from"./input-D4MuOGPQ.js";import{P as Ke,u as On,d as Tn}from"./popup-_D5JhN4Y.js";var Re,ut;function Xe(){if(ut)return Re;ut=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Re=n,Re}var je,dt;function Rn(){if(dt)return je;dt=1;var n=typeof he=="object"&&he&&he.Object===Object&&he;return je=n,je}var Ne,ft;function Ht(){if(ft)return Ne;ft=1;var n=Rn(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return Ne=t,Ne}var Ie,mt;function jn(){if(mt)return Ie;mt=1;var n=Ht(),e=function(){return n.Date.now()};return Ie=e,Ie}var $e,ht;function Nn(){if(ht)return $e;ht=1;var n=/\s/;function e(t){for(var r=t.length;r--&&n.test(t.charAt(r)););return r}return $e=e,$e}var Me,vt;function In(){if(vt)return Me;vt=1;var n=Nn(),e=/^\s+/;function t(r){return r&&r.slice(0,n(r)+1).replace(e,"")}return Me=t,Me}var De,gt;function Ut(){if(gt)return De;gt=1;var n=Ht(),e=n.Symbol;return De=e,De}var Fe,pt;function $n(){if(pt)return Fe;pt=1;var n=Ut(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,o=n?n.toStringTag:void 0;function s(a){var d=t.call(a,o),h=a[o];try{a[o]=void 0;var v=!0}catch{}var b=r.call(a);return v&&(d?a[o]=h:delete a[o]),b}return Fe=s,Fe}var Le,yt;function Mn(){if(yt)return Le;yt=1;var n=Object.prototype,e=n.toString;function t(r){return e.call(r)}return Le=t,Le}var Pe,bt;function Dn(){if(bt)return Pe;bt=1;var n=Ut(),e=$n(),t=Mn(),r="[object Null]",o="[object Undefined]",s=n?n.toStringTag:void 0;function a(d){return d==null?d===void 0?o:r:s&&s in Object(d)?e(d):t(d)}return Pe=a,Pe}var Ae,_t;function Fn(){if(_t)return Ae;_t=1;function n(e){return e!=null&&typeof e=="object"}return Ae=n,Ae}var Be,Ct;function Ln(){if(Ct)return Be;Ct=1;var n=Dn(),e=Fn(),t="[object Symbol]";function r(o){return typeof o=="symbol"||e(o)&&n(o)==t}return Be=r,Be}var We,Et;function Pn(){if(Et)return We;Et=1;var n=In(),e=Xe(),t=Ln(),r=NaN,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,d=parseInt;function h(v){if(typeof v=="number")return v;if(t(v))return r;if(e(v)){var b=typeof v.valueOf=="function"?v.valueOf():v;v=e(b)?b+"":b}if(typeof v!="string")return v===0?v:+v;v=n(v);var f=s.test(v);return f||a.test(v)?d(v.slice(2),f?2:8):o.test(v)?r:+v}return We=h,We}var qe,wt;function An(){if(wt)return qe;wt=1;var n=Xe(),e=jn(),t=Pn(),r="Expected a function",o=Math.max,s=Math.min;function a(d,h,v){var b,f,_,m,g,O,k=0,C=!1,x=!1,i=!0;if(typeof d!="function")throw new TypeError(r);h=t(h)||0,n(v)&&(C=!!v.leading,x="maxWait"in v,_=x?o(t(v.maxWait)||0,h):_,i="trailing"in v?!!v.trailing:i);function l(S){var R=b,U=f;return b=f=void 0,k=S,m=d.apply(U,R),m}function u(S){return k=S,g=setTimeout(j,h),C?l(S):m}function E(S){var R=S-O,U=S-k,ae=h-R;return x?s(ae,_-U):ae}function w(S){var R=S-O,U=S-k;return O===void 0||R>=h||R<0||x&&U>=_}function j(){var S=e();if(w(S))return N(S);g=setTimeout(j,E(S))}function N(S){return g=void 0,i&&b?l(S):(b=f=void 0,m)}function $(){g!==void 0&&clearTimeout(g),k=0,b=O=f=g=void 0}function L(){return g===void 0?m:N(e())}function T(){var S=e(),R=w(S);if(b=arguments,f=this,O=S,R){if(g===void 0)return u(O);if(x)return clearTimeout(g),g=setTimeout(j,h),l(O)}return g===void 0&&(g=setTimeout(j,h)),m}return T.cancel=$,T.flush=L,T}return qe=a,qe}var Ve,xt;function Bn(){if(xt)return Ve;xt=1;var n=An(),e=Xe(),t="Expected a function";function r(o,s,a){var d=!0,h=!0;if(typeof o!="function")throw new TypeError(t);return e(a)&&(d="leading"in a?!!a.leading:d,h="trailing"in a?!!a.trailing:h),n(o,s,{leading:d,maxWait:s,trailing:h})}return Ve=r,Ve}var Wn=Bn();const qn=Mt(Wn);var kt={},St;function Vn(){return St||(St=1,function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function n(i){try{return i.defaultView&&i.defaultView.frameElement||null}catch{return null}}var e=function(i){for(var l=i,u=n(l);u;)l=u.ownerDocument,u=n(l);return l}(window.document),t=[],r=null,o=null;function s(i){this.time=i.time,this.target=i.target,this.rootBounds=g(i.rootBounds),this.boundingClientRect=g(i.boundingClientRect),this.intersectionRect=g(i.intersectionRect||m()),this.isIntersecting=!!i.intersectionRect;var l=this.boundingClientRect,u=l.width*l.height,E=this.intersectionRect,w=E.width*E.height;u?this.intersectionRatio=Number((w/u).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function a(i,l){var u=l||{};if(typeof i!="function")throw new Error("callback must be a function");if(u.root&&u.root.nodeType!=1&&u.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=h(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=i,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(u.rootMargin),this.thresholds=this._initThresholds(u.threshold),this.root=u.root||null,this.rootMargin=this._rootMarginValues.map(function(E){return E.value+E.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return r||(r=function(i,l){!i||!l?o=m():o=O(i,l),t.forEach(function(u){u._checkForIntersections()})}),r},a._resetCrossOriginUpdater=function(){r=null,o=null},a.prototype.observe=function(i){var l=this._observationTargets.some(function(u){return u.element==i});if(!l){if(!(i&&i.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:i,entry:null}),this._monitorIntersections(i.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(i){this._observationTargets=this._observationTargets.filter(function(l){return l.element!=i}),this._unmonitorIntersections(i.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var i=this._queuedEntries.slice();return this._queuedEntries=[],i},a.prototype._initThresholds=function(i){var l=i||[0];return Array.isArray(l)||(l=[l]),l.sort().filter(function(u,E,w){if(typeof u!="number"||isNaN(u)||u<0||u>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return u!==w[E-1]})},a.prototype._parseRootMargin=function(i){var l=i||"0px",u=l.split(/\s+/).map(function(E){var w=/^(-?\d*\.?\d+)(px|%)$/.exec(E);if(!w)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(w[1]),unit:w[2]}});return u[1]=u[1]||u[0],u[2]=u[2]||u[0],u[3]=u[3]||u[1],u},a.prototype._monitorIntersections=function(i){var l=i.defaultView;if(l&&this._monitoringDocuments.indexOf(i)==-1){var u=this._checkForIntersections,E=null,w=null;this.POLL_INTERVAL?E=l.setInterval(u,this.POLL_INTERVAL):(v(l,"resize",u,!0),v(i,"scroll",u,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in l&&(w=new l.MutationObserver(u),w.observe(i,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(i),this._monitoringUnsubscribes.push(function(){var $=i.defaultView;$&&(E&&$.clearInterval(E),b($,"resize",u,!0)),b(i,"scroll",u,!0),w&&w.disconnect()});var j=this.root&&(this.root.ownerDocument||this.root)||e;if(i!=j){var N=n(i);N&&this._monitorIntersections(N.ownerDocument)}}},a.prototype._unmonitorIntersections=function(i){var l=this._monitoringDocuments.indexOf(i);if(l!=-1){var u=this.root&&(this.root.ownerDocument||this.root)||e,E=this._observationTargets.some(function(N){var $=N.element.ownerDocument;if($==i)return!0;for(;$&&$!=u;){var L=n($);if($=L&&L.ownerDocument,$==i)return!0}return!1});if(!E){var w=this._monitoringUnsubscribes[l];if(this._monitoringDocuments.splice(l,1),this._monitoringUnsubscribes.splice(l,1),w(),i!=u){var j=n(i);j&&this._unmonitorIntersections(j.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var i=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var l=0;l<i.length;l++)i[l]()},a.prototype._checkForIntersections=function(){if(!(!this.root&&r&&!o)){var i=this._rootIsInDom(),l=i?this._getRootRect():m();this._observationTargets.forEach(function(u){var E=u.element,w=_(E),j=this._rootContainsTarget(E),N=u.entry,$=i&&j&&this._computeTargetAndRootIntersection(E,w,l),L=null;this._rootContainsTarget(E)?(!r||this.root)&&(L=l):L=m();var T=u.entry=new s({time:d(),target:E,boundingClientRect:w,rootBounds:L,intersectionRect:$});N?i&&j?this._hasCrossedThreshold(N,T)&&this._queuedEntries.push(T):N&&N.isIntersecting&&this._queuedEntries.push(T):this._queuedEntries.push(T)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(i,l,u){if(window.getComputedStyle(i).display!="none"){for(var E=l,w=C(i),j=!1;!j&&w;){var N=null,$=w.nodeType==1?window.getComputedStyle(w):{};if($.display=="none")return null;if(w==this.root||w.nodeType==9)if(j=!0,w==this.root||w==e)r&&!this.root?!o||o.width==0&&o.height==0?(w=null,N=null,E=null):N=o:N=u;else{var L=C(w),T=L&&_(L),S=L&&this._computeTargetAndRootIntersection(L,T,u);T&&S?(w=L,N=O(T,S)):(w=null,E=null)}else{var R=w.ownerDocument;w!=R.body&&w!=R.documentElement&&$.overflow!="visible"&&(N=_(w))}if(N&&(E=f(N,E)),!E)break;w=w&&C(w)}return E}},a.prototype._getRootRect=function(){var i;if(this.root&&!x(this.root))i=_(this.root);else{var l=x(this.root)?this.root:e,u=l.documentElement,E=l.body;i={top:0,left:0,right:u.clientWidth||E.clientWidth,width:u.clientWidth||E.clientWidth,bottom:u.clientHeight||E.clientHeight,height:u.clientHeight||E.clientHeight}}return this._expandRectByRootMargin(i)},a.prototype._expandRectByRootMargin=function(i){var l=this._rootMarginValues.map(function(E,w){return E.unit=="px"?E.value:E.value*(w%2?i.width:i.height)/100}),u={top:i.top-l[0],right:i.right+l[1],bottom:i.bottom+l[2],left:i.left-l[3]};return u.width=u.right-u.left,u.height=u.bottom-u.top,u},a.prototype._hasCrossedThreshold=function(i,l){var u=i&&i.isIntersecting?i.intersectionRatio||0:-1,E=l.isIntersecting?l.intersectionRatio||0:-1;if(u!==E)for(var w=0;w<this.thresholds.length;w++){var j=this.thresholds[w];if(j==u||j==E||j<u!=j<E)return!0}},a.prototype._rootIsInDom=function(){return!this.root||k(e,this.root)},a.prototype._rootContainsTarget=function(i){var l=this.root&&(this.root.ownerDocument||this.root)||e;return k(l,i)&&(!this.root||l==i.ownerDocument)},a.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},a.prototype._unregisterInstance=function(){var i=t.indexOf(this);i!=-1&&t.splice(i,1)};function d(){return window.performance&&performance.now&&performance.now()}function h(i,l){var u=null;return function(){u||(u=setTimeout(function(){i(),u=null},l))}}function v(i,l,u,E){typeof i.addEventListener=="function"?i.addEventListener(l,u,E):typeof i.attachEvent=="function"&&i.attachEvent("on"+l,u)}function b(i,l,u,E){typeof i.removeEventListener=="function"?i.removeEventListener(l,u,E):typeof i.detachEvent=="function"&&i.detachEvent("on"+l,u)}function f(i,l){var u=Math.max(i.top,l.top),E=Math.min(i.bottom,l.bottom),w=Math.max(i.left,l.left),j=Math.min(i.right,l.right),N=j-w,$=E-u;return N>=0&&$>=0&&{top:u,bottom:E,left:w,right:j,width:N,height:$}||null}function _(i){var l;try{l=i.getBoundingClientRect()}catch{}return l?(l.width&&l.height||(l={top:l.top,right:l.right,bottom:l.bottom,left:l.left,width:l.right-l.left,height:l.bottom-l.top}),l):m()}function m(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function g(i){return!i||"x"in i?i:{top:i.top,y:i.top,bottom:i.bottom,left:i.left,x:i.left,right:i.right,width:i.width,height:i.height}}function O(i,l){var u=l.top-i.top,E=l.left-i.left;return{top:u,left:E,height:l.height,width:l.width,bottom:u+l.height,right:E+l.width}}function k(i,l){for(var u=l;u;){if(u==i)return!0;u=C(u)}return!1}function C(i){var l=i.parentNode;return i.nodeType==9&&i!=e?n(i):(l&&l.assignedSlot&&(l=l.assignedSlot.parentNode),l&&l.nodeType==11&&l.host?l.host:l)}function x(i){return i&&i.nodeType===9}window.IntersectionObserver=a,window.IntersectionObserverEntry=s}()),kt}Vn();function zn(n,e){var t={},r=t.callback,o=Dt(t,["callback"]),s=Ee(p.useState(),2),a=s[0],d=s[1],h=Ee(p.useState(),2),v=h[0],b=h[1];return xn(function(){var f=Array.isArray(n)?n:[n],_=f.map(function(g){return ct(g)}).filter(Boolean);if(_.length){var m=new IntersectionObserver(function(g){var O,k;try{for(var C=tn(g),x=C.next();!x.done;x=C.next()){var i=x.value;b(i.intersectionRatio),d(i.isIntersecting),r==null||r(i)}}catch(l){O={error:l}}finally{try{x&&!x.done&&(k=C.return)&&k.call(C)}finally{if(O)throw O.error}}},at(at({},o),{root:ct(void 0)}));return _.forEach(function(g){return m.observe(g)}),function(){m.disconnect()}}},[void 0,void 0,r],n),[a,v]}function Hn(n){var e=this,t=p.useRef(!1);return p.useCallback(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return J(e,void 0,void 0,function(){var s,a;return nn(this,function(d){switch(d.label){case 0:if(t.current)return[2];t.current=!0,d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,n.apply(void 0,Ft([],Ee(r),!1))];case 2:return s=d.sent(),[2,s];case 3:throw a=d.sent(),a;case 4:return t.current=!1,[7];case 5:return[2]}})})},[n])}function Gt(n,e){var t,r=kn(n),o=(t=e==null?void 0:e.wait)!==null&&t!==void 0?t:1e3,s=p.useMemo(function(){return qn(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return r.current.apply(r,Ft([],Ee(a),!1))},o,e)},[]);return Sn(function(){s.cancel()}),{run:s,cancel:s.cancel,flush:s.flush}}function Un(n){return p.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},n,{style:Object.assign({verticalAlign:"-0.125em"},n.style),className:["antd-mobile-icon",n.className].filter(Boolean).join(" ")}),p.createElement("g",{id:"DownOutline-DownOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},p.createElement("g",null,p.createElement("rect",{id:"DownOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),p.createElement("path",{d:"M5.11219264,16.3947957 L22.6612572,34.5767382 L22.6612572,34.5767382 C23.2125856,35.1304785 24.0863155,35.1630514 24.6755735,34.6744571 L24.7825775,34.5767382 L42.8834676,16.3956061 C42.9580998,16.320643 43,16.2191697 43,16.1133896 L43,12.9866673 C43,12.7657534 42.8209139,12.5866673 42.6,12.5866673 C42.4936115,12.5866673 42.391606,12.6290496 42.316542,12.7044413 L23.7816937,31.3201933 L23.7816937,31.3201933 L5.6866816,12.7237117 C5.53262122,12.5653818 5.27937888,12.5619207 5.121049,12.7159811 C5.04365775,12.7912854 5,12.8946805 5,13.0026627 L5,16.1170064 C5,16.2206403 5.04022164,16.3202292 5.11219264,16.3947957 Z",id:"DownOutline-down",fill:"currentColor",fillRule:"nonzero"}))))}function Gn(n){return p.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},n,{style:Object.assign({verticalAlign:"-0.125em"},n.style),className:["antd-mobile-icon",n.className].filter(Boolean).join(" ")}),p.createElement("g",{id:"SearchOutline-SearchOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},p.createElement("g",{id:"SearchOutline-编组"},p.createElement("rect",{id:"SearchOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),p.createElement("path",{d:"M10.2434135,10.1505371 C17.2346315,3.28315429 28.5696354,3.28315429 35.5608534,10.1505371 C42.3159331,16.7859644 42.5440954,27.4048667 36.2453405,34.3093889 L43.7095294,41.6422249 C43.8671196,41.7970419 43.8693677,42.0502979 43.7145508,42.2078881 C43.7128864,42.2095822 43.7112069,42.2112616 43.7095126,42.2129259 L42.1705322,43.7246464 C42.014915,43.8775072 41.7655181,43.8775006 41.6099089,43.7246316 L34.0775268,36.3248916 L34.0775268,36.3248916 C27.0485579,41.8551751 16.7593545,41.4200547 10.2434135,35.0195303 C3.25219551,28.1521474 3.25219551,17.0179199 10.2434135,10.1505371 Z M12.3532001,12.2229532 C6.52718516,17.9457722 6.52718516,27.2242951 12.3532001,32.9471142 C18.1792151,38.6699332 27.6250517,38.6699332 33.4510667,32.9471142 C39.2770817,27.2242951 39.2770817,17.9457722 33.4510667,12.2229532 C27.6250517,6.50013419 18.1792151,6.50013419 12.3532001,12.2229532 Z",id:"SearchOutline-形状",fill:"currentColor",fillRule:"nonzero"}))))}var K={},Ot;function Yn(){if(Ot)return K;Ot=1;var n=K&&K.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(K,"__esModule",{value:!0}),K.staged=void 0;const e=n(rn());function t(s){return typeof s=="function"?e.default.createElement(r,{stage:s}):s}function r(s){const a=s.stage();return t(a)}function o(s){return function(d,h){const v=s(d,h);return t(v)}}return K.staged=o,K}var Zn=Yn();function ve(n){return typeof n=="number"?`${n}px`:n}const Qn=n=>{const e=p.useRef(null),[t]=zn(e);return p.useEffect(()=>{t&&n.onActive()},[t]),c.createElement("div",{ref:e})},Kn=()=>c.createElement("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M41.396 6.234c1.923 0 3.487 1.574 3.487 3.505v29.14c0 1.937-1.568 3.51-3.491 3.51H6.604c-1.923 0-3.487-1.573-3.487-3.51V9.745c0-1.936 1.564-3.51 3.487-3.51Zm0 2.847H6.604c-.355 0-.654.3-.654.658V34.9l5.989-8.707a2.373 2.373 0 0 1 1.801-1.005 2.405 2.405 0 0 1 1.933.752l4.182 4.525 7.58-11.005a2.374 2.374 0 0 1 1.96-1.01c.79 0 1.532.38 1.966 1.01L42.05 34.89V9.74a.664.664 0 0 0-.654-.658Zm-28.305 2.763a3.119 3.119 0 0 1 3.117 3.117 3.119 3.119 0 0 1-3.117 3.117 3.122 3.122 0 0 1-3.117-3.117 3.119 3.119 0 0 1 3.117-3.117Z",fill:"#DBDBDB",fillRule:"nonzero"})),Xn=()=>c.createElement("svg",{viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M19.233 6.233 17.42 9.08l-10.817.001a.665.665 0 0 0-.647.562l-.007.096V34.9l5.989-8.707a2.373 2.373 0 0 1 1.801-1.005 2.415 2.415 0 0 1 1.807.625l.126.127 4.182 4.525 2.267-3.292 5.461 7.841-4.065 7.375H6.604c-1.86 0-3.382-1.47-3.482-3.317l-.005-.192V9.744c0-1.872 1.461-3.405 3.296-3.505l.19-.005h12.63Zm22.163 0c1.86 0 3.382 1.472 3.482 3.314l.005.192v29.14a3.507 3.507 0 0 1-3.3 3.505l-.191.006H27.789l3.63-6.587.06-.119a1.87 1.87 0 0 0-.163-1.853l-6.928-9.949 3.047-4.422a2.374 2.374 0 0 1 1.96-1.01 2.4 2.4 0 0 1 1.86.87l.106.14L42.05 34.89V9.74a.664.664 0 0 0-.654-.658H21.855l1.812-2.848h17.73Zm-28.305 5.611c.794 0 1.52.298 2.07.788l-.843 1.325-.067.114a1.87 1.87 0 0 0 .11 1.959l.848 1.217c-.556.515-1.3.83-2.118.83a3.122 3.122 0 0 1-3.117-3.116 3.119 3.119 0 0 1 3.117-3.117Z",fill:"#DBDBDB",fillRule:"nonzero"})),we="adm-image",Jn={fit:"fill",placeholder:c.createElement("div",{className:`${we}-tip`},c.createElement(Kn,null)),fallback:c.createElement("div",{className:`${we}-tip`},c.createElement(Xn,null)),lazy:!1,draggable:!1},er=Zn.staged(n=>{const e=B(Jn,n),[t,r]=p.useState(!1),[o,s]=p.useState(!1),a=p.useRef(null),d=p.useRef(null);let h=e.src,v=e.srcSet;const[b,f]=p.useState(!e.lazy);h=b?e.src:void 0,v=b?e.srcSet:void 0,zt(()=>{r(!1),s(!1)},[h]),p.useEffect(()=>{var g;!((g=d.current)===null||g===void 0)&&g.complete&&r(!0)},[]);function _(){if(o)return c.createElement(c.Fragment,null,e.fallback);const g=c.createElement("img",{ref:d,id:e.id,className:`${we}-img`,src:h,alt:e.alt,onClick:e.onClick,onLoad:O=>{var k;r(!0),(k=e.onLoad)===null||k===void 0||k.call(e,O)},onError:O=>{var k;s(!0),(k=e.onError)===null||k===void 0||k.call(e,O)},style:{objectFit:e.fit,display:t?"block":"none"},crossOrigin:e.crossOrigin,decoding:e.decoding,loading:e.loading,referrerPolicy:e.referrerPolicy,sizes:e.sizes,srcSet:v,useMap:e.useMap,draggable:e.draggable});return c.createElement(c.Fragment,null,!t&&e.placeholder,g)}const m={};return e.width&&(m["--width"]=ve(e.width),m.width=ve(e.width)),e.height&&(m["--height"]=ve(e.height),m.height=ve(e.height)),A(e,c.createElement("div",{ref:a,className:we,style:m,onClick:e.onContainerClick},e.lazy&&!b&&c.createElement(Qn,{onActive:()=>{f(!0)}}),_()))});var _e={exports:{}},tr=_e.exports,Tt;function nr(){return Tt||(Tt=1,function(n,e){(function(t,r){n.exports=r()})(tr,function(){var t="day";return function(r,o,s){var a=function(v){return v.add(4-v.isoWeekday(),t)},d=o.prototype;d.isoWeekYear=function(){return a(this).year()},d.isoWeek=function(v){if(!this.$utils().u(v))return this.add(7*(v-this.isoWeek()),t);var b,f,_,m,g=a(this),O=(b=this.isoWeekYear(),f=this.$u,_=(f?s.utc:s)().year(b).startOf("year"),m=4-_.isoWeekday(),_.isoWeekday()>4&&(m+=7),_.add(m,t));return g.diff(O,"week")+1},d.isoWeekday=function(v){return this.$utils().u(v)?this.day()||7:this.day(this.day()%7?v:v-7)};var h=d.startOf;d.startOf=function(v,b){var f=this.$utils(),_=!!f.u(b)||b;return f.p(v)==="isoweek"?_?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):h.bind(this)(v,b)}}})}(_e)),_e.exports}var rr=nr();const or=Mt(rr);function Rt(n,e){return n===void 0||e===null?null:Array.isArray(e)?e:[e,e]}function ir(n){return M().year(n.year).month(n.month-1).date(1)}function sr(n){var e=p.useRef();e.current=n;var t=p.useCallback(function(){for(var r,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(s))},[]);return t}Number(p.version.split(".")[0]);function ar(n,e,t){const r=p.useRef(),o=()=>{r.current&&cancelAnimationFrame(r.current)},s=sr(a=>{o(),r.current=requestAnimationFrame(()=>{if(t.current){const d=a.format("YYYY-M"),h=t.current.querySelector(`[data-year-month="${d}"]`);h&&h.scrollIntoView({block:"start",inline:"nearest"})}})});return p.useEffect(()=>{if(e&&n)return s(n),o},[n,e]),s}M.extend(or);M.extend(on);const F="adm-calendar-picker-view",Yt=c.createContext({visible:!1}),lr={weekStartsOn:"Sunday",defaultValue:null,allowClear:!0,usePopup:!0,selectionMode:"single"},cr=p.forwardRef((n,e)=>{var t;const r=p.useRef(null),o=M(),s=B(lr,n),{locale:a}=ue(),d=[...a.Calendar.markItems];if(s.weekStartsOn==="Sunday"){const T=d.pop();T&&d.unshift(T)}const[h,v]=Ze({value:s.value===void 0?void 0:Rt(s.selectionMode,s.value),defaultValue:Rt(s.selectionMode,s.defaultValue),onChange:T=>{var S,R;s.selectionMode==="single"?(S=s.onChange)===null||S===void 0||S.call(s,T?T[0]:null):s.selectionMode==="range"&&((R=s.onChange)===null||R===void 0||R.call(s,T))}}),[b,f]=p.useState(!1),[_,m]=p.useState(()=>M(h?h[0]:o).date(1)),g=T=>{T&&m(M(T[0]).date(1)),v(T)},O=s.title!==!1,k=p.useContext(Yt),C=ar(_,k.visible,r),[x,i]=p.useState(_),[l,u]=p.useState(()=>_.add(6,"month"));p.useEffect(()=>{if(h){const[T,S]=h;!s.min&&T&&M(T).isBefore(x)&&i(M(T).date(1)),!s.max&&S&&M(S).isAfter(l)&&u(M(S).endOf("month"))}},[h]);const E=p.useMemo(()=>s.max?M(s.max):l,[s.max,l]),w=p.useMemo(()=>s.min?M(s.min):x,[s.min,x]);p.useImperativeHandle(e,()=>({jumpTo:T=>{let S;typeof T=="function"?S=T({year:_.year(),month:_.month()+1}):S=T;const R=ir(S);m(R),C(R)},jumpToToday:()=>{const T=M().date(1);m(T),C(T)},getDateRange:()=>h}));const j=c.createElement("div",{className:`${F}-header`},c.createElement("div",{className:`${F}-title`},(t=s.title)!==null&&t!==void 0?t:a.Calendar.title));function N(){var T;const S=[];let R=w;for(;R.isSameOrBefore(E,"month");){const U=R.year(),ae=R.month()+1,Kt={year:U,month:ae},tt=`${U}-${ae}`,nt=s.weekStartsOn==="Monday"?R.date(1).isoWeekday()-1:R.date(1).isoWeekday(),Xt=nt==7?null:Array(nt).fill(null).map((rt,le)=>c.createElement("div",{key:le,className:`${F}-cell`}));S.push(c.createElement("div",{key:tt,"data-year-month":tt},c.createElement("div",{className:`${F}-title`},(T=a.Calendar.yearAndMonth)===null||T===void 0?void 0:T.replace(/\${(.*?)}/g,(rt,le)=>{var I;return(I=Kt[le])===null||I===void 0?void 0:I.toString()})),c.createElement("div",{className:`${F}-cells`},Xt,Array(R.daysInMonth()).fill(null).map((rt,le)=>{const I=R.date(le+1);let me=!1,te=!1,ne=!1,ot=!1,it=!1;if(h){const[D,W]=h;te=I.isSame(D,"day"),ne=I.isSame(W,"day"),me=te||ne||I.isAfter(D,"day")&&I.isBefore(W,"day"),me&&(ot=(S.length%7===0||I.isSame(I.startOf("month"),"day"))&&!te,it=(S.length%7===6||I.isSame(I.endOf("month"),"day"))&&!ne)}const st=s.shouldDisableDate?s.shouldDisableDate(I.toDate()):E&&I.isAfter(E,"day")||w&&I.isBefore(w,"day"),Jt=()=>{var D;if(s.renderTop===!1)return null;const W=Te=>c.createElement("div",{className:`${F}-cell-top`},Te),G=(D=s.renderTop)===null||D===void 0?void 0:D.call(s,I.toDate());if(G)return W(G);if(s.selectionMode==="range"){if(te&&ne)return W(a.Calendar.startAndEnd);if(te)return W(a.Calendar.start);if(ne)return W(a.Calendar.end)}return I.isSame(o,"day")&&!me?W(a.Calendar.today):W(null)},en=()=>{var D;return s.renderBottom===!1?null:c.createElement("div",{className:`${F}-cell-bottom`},(D=s.renderBottom)===null||D===void 0?void 0:D.call(s,I.toDate()))};return c.createElement("div",{key:I.valueOf(),className:P(`${F}-cell`,{[`${F}-cell-today`]:I.isSame(o,"day"),[`${F}-cell-selected`]:me,[`${F}-cell-selected-begin`]:te,[`${F}-cell-selected-end`]:ne,[`${F}-cell-selected-row-begin`]:ot,[`${F}-cell-selected-row-end`]:it,[`${F}-cell-disabled`]:!!st}),onClick:()=>{if(!s.selectionMode||st)return;const D=I.toDate();function W(){if(!s.allowClear||!h)return!1;const[G,Te]=h;return I.isSame(G,"date")&&I.isSame(Te,"day")}if(s.selectionMode==="single"){if(s.allowClear&&W()){g(null);return}g([D,D])}else if(s.selectionMode==="range"){if(!h){g([D,D]),f(!0);return}if(W()){g(null),f(!1);return}if(b){const G=h[0];g(G>D?[D,G]:[G,D]),f(!1)}else g([D,D]),f(!0)}}},Jt(),c.createElement("div",{className:`${F}-cell-date`},s.renderDate?s.renderDate(I.toDate()):I.date()),en())})))),R=R.add(1,"month")}return S}const $=c.createElement("div",{className:`${F}-body`,ref:r},N()),L=c.createElement("div",{className:`${F}-mark`},d.map((T,S)=>c.createElement("div",{key:S,className:`${F}-mark-cell`},T)));return A(s,c.createElement("div",{className:F},O&&j,L,$))}),ge="adm-divider",ur={contentPosition:"center",direction:"horizontal"},dr=n=>{const e=B(ur,n);return A(e,c.createElement("div",{className:P(ge,`${ge}-${e.direction}`,`${ge}-${e.contentPosition}`)},e.children&&c.createElement("div",{className:`${ge}-content`},e.children)))},pe="adm-calendar-picker",fr={weekStartsOn:"Sunday",defaultValue:null,allowClear:!0,usePopup:!0,selectionMode:"single"},mr=p.forwardRef((n,e)=>{const t=B(fr,n),{locale:r}=ue(),o=e??p.useRef(null),{visible:s,confirmText:a,popupClassName:d,popupStyle:h,popupBodyStyle:v,forceRender:b,closeOnMaskClick:f,onClose:_,onConfirm:m,onMaskClick:g,getContainer:O}=t,k=Dt(t,["visible","confirmText","popupClassName","popupStyle","popupBodyStyle","forceRender","closeOnMaskClick","onClose","onConfirm","onMaskClick","getContainer"]),C=c.useMemo(()=>({visible:!!s}),[s]),x=c.createElement("div",{className:`${pe}-footer`},c.createElement(dr,null),c.createElement("div",{className:`${pe}-footer-bottom`},c.createElement(se,{color:"primary",onClick:()=>{var i,l,u,E;const w=(l=(i=o.current)===null||i===void 0?void 0:i.getDateRange())!==null&&l!==void 0?l:null;t.selectionMode==="single"?(u=t.onConfirm)===null||u===void 0||u.call(t,w?w[0]:null):t.selectionMode==="range"&&((E=t.onConfirm)===null||E===void 0||E.call(t,w)),_==null||_()}},a??r.Calendar.confirm)));return A(t,c.createElement("div",{className:pe},c.createElement(Ke,{visible:s,className:P(`${pe}-popup`,d),showCloseButton:!0,forceRender:e?!0:b,style:h,bodyStyle:Object.assign({borderTopLeftRadius:"8px",borderTopRightRadius:"8px",minHeight:"80vh",overflow:"auto"},v),onClose:_,onMaskClick:()=>{g==null||g(),f&&(_==null||_())},getContainer:O},c.createElement(Yt.Provider,{value:C},c.createElement(cr,Object.assign({ref:o},k))),x)))});function hr(n,e){const t=Lt(n);Qe(()=>{const r=e.current;if(r)if(window.ResizeObserver){let o;const s=new ResizeObserver(()=>{o=window.requestAnimationFrame(()=>t(r))});return s.observe(r),()=>{window.cancelAnimationFrame(o),s.disconnect()}}else t(r)},[e])}function vr(n,e,t){if(n&&typeof MutationObserver<"u"){let r=new MutationObserver(()=>{t()});return r.observe(n,e),()=>{r&&(r.disconnect(),r=null)}}return()=>{}}function gr(n,e,t){const r=Lt(n);p.useEffect(()=>vr(e.current,t,r),[e])}const pr=(n,e)=>{const[{scrollLeft:t},r]=xe(()=>({scrollLeft:0,config:{tension:300,clamp:!0}}));function o(s=!1){const a=n.current;if(!a||e===void 0)return;const h=a.children.item(e).children.item(0),v=h.offsetLeft,b=h.offsetWidth,f=a.offsetWidth,_=a.scrollWidth,m=a.scrollLeft;if(_-f<=0)return;const O=En(v-(f-b)/2,0,_-f);r.start({scrollLeft:O,from:{scrollLeft:m},immediate:s&&!t.isAnimating})}return Qe(()=>{o(!0)},[]),zt(()=>{o()},[e]),gr(()=>{o(!0)},n,{subtree:!0,childList:!0,characterData:!0}),{scrollLeft:t,animate:o}},ye="adm-scroll-mask",yr=n=>{const e=p.useRef(null),[{leftMaskOpacity:t,rightMaskOpacity:r},o]=xe(()=>({leftMaskOpacity:0,rightMaskOpacity:0,config:{clamp:!0}})),{run:s}=Gt((a=!1)=>{if(!e.current)return;const h=n.scrollTrackRef.current;if(!h)return;const v=h.scrollLeft,b=v>0,f=v+h.offsetWidth<h.scrollWidth;o.start({leftMaskOpacity:b?1:0,rightMaskOpacity:f?1:0,immediate:a})},{wait:100,trailing:!0,leading:!0});return p.useEffect(()=>{s(!0)},[]),p.useEffect(()=>{const a=n.scrollTrackRef.current;if(a)return a.addEventListener("scroll",s),()=>a.removeEventListener("scroll",s)},[]),c.createElement(c.Fragment,null,c.createElement(oe.div,{ref:e,className:P(ye,`${ye}-left`),style:{opacity:t}}),c.createElement(oe.div,{className:P(ye,`${ye}-right`),style:{opacity:r}}))},Y="adm-capsule-tabs",br=()=>null,_r=n=>{var e;const t=p.useRef(null),r=p.useRef(null),o={};let s=null;const a=[];sn(n.children,(f,_)=>{if(!p.isValidElement(f))return;const m=f.key;if(typeof m!="string")return;_===0&&(s=m);const g=a.push(f);o[m]=g-1});const[d,h]=Ze({value:n.activeKey,defaultValue:(e=n.defaultActiveKey)!==null&&e!==void 0?e:s,onChange:f=>{var _;f!==null&&((_=n.onChange)===null||_===void 0||_.call(n,f))}}),{scrollLeft:v,animate:b}=pr(t,o[d]);return hr(()=>{b(!0)},r),A(n,c.createElement("div",{className:Y,ref:r},c.createElement("div",{className:`${Y}-header`},c.createElement(yr,{scrollTrackRef:t}),c.createElement(oe.div,{className:`${Y}-tab-list`,ref:t,scrollLeft:v},a.map(f=>A(f.props,c.createElement("div",{key:f.key,className:`${Y}-tab-wrapper`},c.createElement("div",{onClick:()=>{const{key:_}=f;f.props.disabled||_!=null&&h(_.toString())},className:P(`${Y}-tab`,{[`${Y}-tab-active`]:f.key===d,[`${Y}-tab-disabled`]:f.props.disabled})},f.props.title)))))),a.map(f=>{if(f.props.children===void 0)return null;const _=f.key===d;return c.createElement(Pt,{key:f.key,active:_,forceRender:f.props.forceRender,destroyOnClose:f.props.destroyOnClose},c.createElement("div",{className:`${Y}-content`,style:{display:_?"block":"none"}},f.props.children))})))},ze=At(_r,{Tab:br}),ce="adm-center-popup",Cr=Object.assign(Object.assign({},Tn),{getContainer:null}),Er=n=>{const{popup:e={}}=ue(),t=B(Cr,e,n),r=an(),o=xe({scale:t.visible?1:.8,opacity:t.visible?1:0,config:{mass:1.2,tension:200,friction:25,clamp:!0},onRest:()=>{var f,_;r.current||(a(t.visible),t.visible?(f=t.afterShow)===null||f===void 0||f.call(t):(_=t.afterClose)===null||_===void 0||_.call(t))}}),[s,a]=p.useState(t.visible);Qe(()=>{t.visible&&a(!0)},[t.visible]);const d=p.useRef(null);ln(d,t.disableBodyScroll&&s);const h=On(s&&t.visible),v=c.createElement("div",{className:P(`${ce}-body`,t.bodyClassName),style:t.bodyStyle},t.children),b=Ue(t.stopPropagation,A(t,c.createElement("div",{className:ce,style:{display:s?void 0:"none",pointerEvents:s?void 0:"none"}},t.mask&&c.createElement(cn,{visible:h,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose,onMaskClick:f=>{var _,m;(_=t.onMaskClick)===null||_===void 0||_.call(t,f),t.closeOnMaskClick&&((m=t.onClose)===null||m===void 0||m.call(t))},style:t.maskStyle,className:P(`${ce}-mask`,t.maskClassName),disableBodyScroll:!1,stopPropagation:t.stopPropagation}),c.createElement("div",{className:`${ce}-wrap`,role:t.role,"aria-label":t["aria-label"]},c.createElement(oe.div,{style:Object.assign(Object.assign({},o),{pointerEvents:o.opacity.to(f=>f===1?"unset":"none")}),ref:d},t.showCloseButton&&c.createElement("a",{className:P(`${ce}-close`,"adm-plain-anchor"),onClick:()=>{var f;(f=t.onClose)===null||f===void 0||f.call(t)}},t.closeIcon),v)))));return c.createElement(Pt,{active:s,forceRender:t.forceRender,destroyOnClose:t.destroyOnClose},un(t.getContainer,b))},wr=n=>{const{action:e}=n;return A(n.action,c.createElement(se,{key:e.key,onClick:n.onAction,className:P("adm-dialog-button",{"adm-dialog-button-bold":e.bold}),fill:"none",shape:"rectangular",block:!0,color:e.danger?"danger":"primary",loading:"auto",disabled:e.disabled},e.text))},xr={actions:[],closeOnAction:!1,closeOnMaskClick:!1,getContainer:null},Zt=n=>{const e=B(xr,n),t=c.createElement(c.Fragment,null,!!e.image&&c.createElement("div",{className:V("image-container")},c.createElement(er,{src:e.image,alt:"dialog header image",width:"100%"})),!!e.header&&c.createElement("div",{className:V("header")},c.createElement(lt,null,e.header)),!!e.title&&c.createElement("div",{className:V("title")},e.title),c.createElement("div",{className:P(V("content"),!e.content&&V("content-empty"))},typeof e.content=="string"?c.createElement(lt,null,e.content):e.content),c.createElement("div",{className:V("footer")},e.actions.map((r,o)=>{const s=Array.isArray(r)?r:[r];return c.createElement("div",{className:V("action-row"),key:o},s.map((a,d)=>c.createElement(wr,{key:a.key,action:a,onAction:()=>J(void 0,void 0,void 0,function*(){var h,v,b;yield Promise.all([(h=a.onClick)===null||h===void 0?void 0:h.call(a),(v=e.onAction)===null||v===void 0?void 0:v.call(e,a,d)]),e.closeOnAction&&((b=e.onClose)===null||b===void 0||b.call(e))})})))})));return c.createElement(Er,{className:P(V(),e.className),style:e.style,afterClose:e.afterClose,afterShow:e.afterShow,onMaskClick:e.closeOnMaskClick?()=>{var r;(r=e.onClose)===null||r===void 0||r.call(e)}:void 0,visible:e.visible,getContainer:e.getContainer,bodyStyle:e.bodyStyle,bodyClassName:P(V("body"),e.image&&V("with-image"),e.bodyClassName),maskStyle:e.maskStyle,maskClassName:e.maskClassName,stopPropagation:e.stopPropagation,disableBodyScroll:e.disableBodyScroll,destroyOnClose:e.destroyOnClose,forceRender:e.forceRender,role:"dialog","aria-label":e["aria-label"]},t)};function V(n=""){return"adm-dialog"+(n&&"-")+n}const Ye=new Set;function Je(n){const e=dn(c.createElement(Zt,Object.assign({},n,{afterClose:()=>{var t;Ye.delete(e.close),(t=n.afterClose)===null||t===void 0||t.call(n)}})));return Ye.add(e.close),e}function kr(n){const e={confirmText:Bt().locale.Dialog.ok},t=B(e,n);return new Promise(r=>{Je(Object.assign(Object.assign({},t),{closeOnAction:!0,actions:[{key:"confirm",text:t.confirmText}],onAction:t.onConfirm,onClose:()=>{var o;(o=t.onClose)===null||o===void 0||o.call(t),r()}}))})}const Sr={confirmText:"确认",cancelText:"取消"};function Or(n){const{locale:e}=Bt(),t=B(Sr,{confirmText:e.common.confirm,cancelText:e.common.cancel},n);return new Promise(r=>{Je(Object.assign(Object.assign({},t),{closeOnAction:!0,onClose:()=>{var o;(o=t.onClose)===null||o===void 0||o.call(t),r(!1)},actions:[[{key:"cancel",text:t.cancelText,onClick:()=>J(this,void 0,void 0,function*(){var o;yield(o=t.onCancel)===null||o===void 0?void 0:o.call(t),r(!1)})},{key:"confirm",text:t.confirmText,bold:!0,onClick:()=>J(this,void 0,void 0,function*(){var o;yield(o=t.onConfirm)===null||o===void 0?void 0:o.call(t),r(!0)})}]]}))})}function Tr(){Ye.forEach(n=>{n()})}const Rr=At(Zt,{show:Je,alert:kr,confirm:Or,clear:Tr});function jr(n,e){return n.reduce((t,r)=>Math.abs(t-e)<Math.abs(r-e)?t:r)}const X="adm-space",Nr={direction:"horizontal"},Ir=n=>{const e=B(Nr,n),{direction:t,onClick:r}=e;return A(e,c.createElement("div",{className:P(X,{[`${X}-wrap`]:e.wrap,[`${X}-block`]:e.block,[`${X}-${t}`]:!0,[`${X}-align-${e.align}`]:!!e.align,[`${X}-justify-${e.justify}`]:!!e.justify}),onClick:r},c.Children.map(e.children,o=>o!=null&&c.createElement("div",{className:`${X}-item`},o))))};function $r(n){return n===window}const Qt="adm-infinite-scroll",Mr={threshold:250,children:(n,e,t)=>c.createElement(Fr,{hasMore:n,failed:e,retry:t})},Dr=n=>{const e=B(Mr,n),[t,r]=p.useState(!1),o=Hn(m=>J(void 0,void 0,void 0,function*(){try{yield e.loadMore(m)}catch(g){throw r(!0),g}})),s=p.useRef(null),[a,d]=p.useState({}),h=p.useRef(a),[v,b]=p.useState(),{run:f}=Gt(()=>J(void 0,void 0,void 0,function*(){if(h.current!==a||!e.hasMore)return;const m=s.current;if(!m||!m.offsetParent)return;const g=fn(m);if(b(g),!g)return;const k=m.getBoundingClientRect().top;if(($r(g)?window.innerHeight:g.getBoundingClientRect().bottom)>=k-e.threshold){const x={};h.current=x;try{yield o(!1),d(x)}catch{}}}),{wait:100,leading:!0,trailing:!0});p.useEffect(()=>{f()}),p.useEffect(()=>{if(!s.current||!v)return;function g(){f()}return v.addEventListener("scroll",g),()=>{v.removeEventListener("scroll",g)}},[v]);function _(){return J(this,void 0,void 0,function*(){r(!1);try{yield o(!0),d(h.current)}catch{}})}return A(e,c.createElement("div",{className:Qt,ref:s},typeof e.children=="function"?e.children(e.hasMore,t,_):e.children))},Fr=n=>{const{locale:e}=ue();return n.hasMore?n.failed?c.createElement("span",null,c.createElement("span",{className:`${Qt}-failed-text`},e.InfiniteScroll.failedToLoad),c.createElement("a",{onClick:()=>{n.retry()}},e.InfiniteScroll.retry)):c.createElement(c.Fragment,null,c.createElement("span",null,e.common.loading),c.createElement(mn,null)):c.createElement("span",null,e.InfiniteScroll.noMore)},re="adm-progress-circle",Lr=n=>{const e=B({percent:0},n),t={"--percent":e.percent.toString()};return A(e,c.createElement("div",{className:`${re}`,style:t},c.createElement("div",{className:`${re}-content`},c.createElement("svg",{className:`${re}-svg`},c.createElement("circle",{className:`${re}-track`,fill:"transparent"}),c.createElement("circle",{className:`${re}-fill`,fill:"transparent"})),c.createElement("div",{className:`${re}-info`},e.children))))},Z="adm-search-bar",Pr={clearable:!0,onlyShowClearWhenFocus:!1,showCancelButton:!1,defaultValue:"",clearOnCancel:!0},Ar=p.forwardRef((n,e)=>{const{locale:t,searchBar:r={}}=ue(),o=B(Pr,r,{cancelText:t.common.cancel},n),s=hn(c.createElement(Gn,null),r.searchIcon,n.icon,n.searchIcon),[a,d]=Ze(o),[h,v]=p.useState(!1),b=p.useRef(null),f=p.useRef(!1);p.useImperativeHandle(e,()=>({clear:()=>{var m;return(m=b.current)===null||m===void 0?void 0:m.clear()},focus:()=>{var m;return(m=b.current)===null||m===void 0?void 0:m.focus()},blur:()=>{var m;return(m=b.current)===null||m===void 0?void 0:m.blur()},get nativeElement(){var m,g;return(g=(m=b.current)===null||m===void 0?void 0:m.nativeElement)!==null&&g!==void 0?g:null}}));const _=()=>{let m;return typeof o.showCancelButton=="function"?m=o.showCancelButton(h,a):m=o.showCancelButton&&h,m&&c.createElement("div",{className:`${Z}-suffix`},c.createElement(se,{fill:"none",className:`${Z}-cancel-button`,onClick:()=>{var g,O,k;o.clearOnCancel&&((g=b.current)===null||g===void 0||g.clear()),(O=b.current)===null||O===void 0||O.blur(),(k=o.onCancel)===null||k===void 0||k.call(o)},onMouseDown:g=>{g.preventDefault()}},o.cancelText))};return A(o,c.createElement("div",{className:P(Z,{[`${Z}-active`]:h})},c.createElement("div",{className:`${Z}-input-box`},s&&c.createElement("div",{className:`${Z}-input-box-icon`},s),c.createElement(Ge,{ref:b,className:P(`${Z}-input`,{[`${Z}-input-without-icon`]:!s}),value:a,onChange:d,maxLength:o.maxLength,autoFocus:o.autoFocus,placeholder:o.placeholder,clearable:o.clearable,onlyShowClearWhenFocus:o.onlyShowClearWhenFocus,onFocus:m=>{var g;v(!0),(g=o.onFocus)===null||g===void 0||g.call(o,m)},onBlur:m=>{var g;v(!1),(g=o.onBlur)===null||g===void 0||g.call(o,m)},onClear:o.onClear,type:"search",enterKeyHint:"search",onEnterPress:()=>{var m,g;f.current||((m=b.current)===null||m===void 0||m.blur(),(g=o.onSearch)===null||g===void 0||g.call(o,a))},"aria-label":t.SearchBar.name,onCompositionStart:m=>{var g;f.current=!0,(g=o.onCompositionStart)===null||g===void 0||g.call(o,m)},onCompositionEnd:m=>{var g;f.current=!1,(g=o.onCompositionEnd)===null||g===void 0||g.call(o,m)}})),_()))}),Q="adm-swipe-action",Br={rightActions:[],leftActions:[],closeOnTouchOutside:!0,closeOnAction:!0,stopPropagation:[]},Wr=p.forwardRef((n,e)=>{const t=B(Br,n),r=p.useRef(null),o=p.useRef(null),s=p.useRef(null);function a(C){const x=C.current;return x?x.offsetWidth:0}function d(){return a(o)}function h(){return a(s)}const[{x:v},b]=xe(()=>({x:0,config:{tension:200,friction:30}}),[]),f=p.useRef(!1),_=p.useRef(null);function m(){var C;(C=_.current)===null||C===void 0||C.call(_),f.current=!1}const g=_n(C=>{var x;if(_.current=C.cancel,!C.intentional||(C.down&&(f.current=!0),!f.current))return;const[i]=C.offset;if(C.last){const l=d(),u=h();let E=i+C.velocity[0]*C.direction[0]*50;i>0?E=Math.max(0,E):i<0?E=Math.min(0,E):E=0;const w=jr([-u,0,l],E);b.start({x:w}),w!==0&&((x=n.onActionsReveal)===null||x===void 0||x.call(n,w>0?"left":"right")),window.setTimeout(()=>{f.current=!1})}else b.start({x:i,immediate:!0})},{from:()=>[v.get(),0],bounds:()=>{const C=d();return{left:-h(),right:C}},axis:"x",preventScroll:!0,pointer:{touch:!0},triggerAllEvents:!0}),O=()=>{var C;b.start({x:0}),m(),(C=t.onClose)===null||C===void 0||C.call(t)};p.useImperativeHandle(e,()=>({show:(C="right")=>{var x;C==="right"?b.start({x:-h()}):C==="left"&&b.start({x:d()}),(x=n.onActionsReveal)===null||x===void 0||x.call(n,C)},close:O})),p.useEffect(()=>{if(!t.closeOnTouchOutside)return;function C(x){if(v.get()===0)return;const i=r.current;i&&!i.contains(x.target)&&O()}return document.addEventListener("touchstart",C),()=>{document.removeEventListener("touchstart",C)}},[t.closeOnTouchOutside]);function k(C){var x,i;const l=(x=C.color)!==null&&x!==void 0?x:"light";return c.createElement(se,{key:C.key,className:`${Q}-action-button`,style:{"--background-color":(i=qr[l])!==null&&i!==void 0?i:l},onClick:u=>{var E,w;t.closeOnAction&&O(),(E=C.onClick)===null||E===void 0||E.call(C,u),(w=t.onAction)===null||w===void 0||w.call(t,C,u)}},C.text)}return A(t,c.createElement("div",Object.assign({className:Q},g(),{ref:r,onClickCapture:C=>{f.current&&(C.stopPropagation(),C.preventDefault())}}),c.createElement(oe.div,{className:`${Q}-track`,style:{x:v}},Ue(t.stopPropagation,c.createElement("div",{className:`${Q}-actions ${Q}-actions-left`,ref:o},t.leftActions.map(k))),c.createElement("div",{className:`${Q}-content`,onClickCapture:C=>{v.goal!==0&&(C.preventDefault(),C.stopPropagation(),O())}},c.createElement(oe.div,{style:{pointerEvents:v.to(C=>C!==0&&v.goal!==0?"none":"auto")}},t.children)),Ue(t.stopPropagation,c.createElement("div",{className:`${Q}-actions ${Q}-actions-right`,ref:s},t.rightActions.map(k))))))}),qr={light:"var(--adm-color-light)",weak:"var(--adm-color-weak)",primary:"var(--adm-color-primary)",success:"var(--adm-color-success)",warning:"var(--adm-color-warning)",danger:"var(--adm-color-danger)"},Vr="_mainText_ckka5_1",zr="_secondaryText_ckka5_6",be={mainText:Vr,secondaryText:zr},Hr="_circle_1b32f_1",Ur="_leftText_1b32f_7",Gr="_kcalText_1b32f_13",He={circle:Hr,leftText:Ur,kcalText:Gr},Yr=()=>y.jsxs(q,{align:"center",children:[y.jsx(ee,{animated:!0,className:He.circle}),y.jsxs(q,{direction:"row",align:"center",gap:8,children:[y.jsx(ee,{animated:!0,className:He.leftText}),y.jsx(ee,{animated:!0,className:He.kcalText})]})]}),Ce=n=>n?`${n} ккал`:"",Zr=n=>n?`${n} г`:"",Qr=(n,e)=>e?Math.floor((n||0)*(e||0)/100):0,Se=(n,e=100)=>n?`${Ce(Math.floor(n))} / ${Zr(e)}`:"",Oe=n=>{const e=[];return n!=null&&n.brands&&e.push(n.brands),n!=null&&n.product_name&&e.push(n.product_name),e.join(" / ").replace(/&quot;/g,'"')},Kr=()=>{const n=de(fe),{data:e,isFetching:t}=wn(),{data:r,isFetching:o}=ke({dateStart:n.dateStart,dateEnd:n.dateEnd}),s=p.useMemo(()=>!(r!=null&&r.totalCalories)||!(e!=null&&e.calories_limit)?0:Math.floor(r.totalCalories*100/e.calories_limit),[e,r]),a=p.useMemo(()=>{if(!(e!=null&&e.calories_limit))return 0;const h=(e==null?void 0:e.calories_limit)-((r==null?void 0:r.totalCalories)??0);return h<0?0:h},[e,r]),d=p.useMemo(()=>{if(!(e!=null&&e.calories_limit))return 0;const h=((r==null?void 0:r.totalCalories)??0)-(e==null?void 0:e.calories_limit);return h<0?0:h},[e,r]);return t||o?y.jsx(Yr,{}):y.jsxs(q,{align:"center",children:[y.jsxs(Lr,{percent:s>100?100:s,style:{"--size":"120px","--track-width":"8px","--fill-color":`var(--adm-color-${s>100?"danger":"primary"})`},children:[y.jsx("div",{className:be.mainText,children:`${s}%`}),y.jsx("div",{className:be.secondaryText,children:Ce(r==null?void 0:r.totalCalories)})]}),y.jsxs(q,{direction:"row",align:"center",gap:8,children:[a>0&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:be.secondaryText,children:"Осталось"}),y.jsx("div",{children:Ce(a)})]}),d>0&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:be.secondaryText,children:"Превышение"}),y.jsx("div",{children:Ce(d)})]})]})]})},Xr="_date_ihy44_1",Jr="_button_ihy44_7",jt={date:Xr,button:Jr},eo=()=>y.jsxs(q,{direction:"row",align:"center",justify:"space-between",children:[y.jsx(ee,{animated:!0,className:jt.date}),y.jsx(ee,{animated:!0,className:jt.button})]}),to="_content_1kmv9_1",no="_filterForm_1kmv9_5",Nt={content:to,filterForm:no},ro="_diaryList_tl3x1_1",oo={diaryList:ro},io="_title_11ld0_1",so="_description_11ld0_7",It={title:io,description:so},et=({count:n=5})=>y.jsx(z,{children:Array.from({length:n}).map((e,t)=>y.jsx(z.Item,{children:y.jsxs(q,{direction:"column",gap:8,children:[y.jsx(ee,{animated:!0,className:It.title}),y.jsx(ee,{animated:!0,className:It.description})]})},t))}),ao=n=>{var v;const{onClickItem:e}=n,t=de(fe),{data:r,error:o,isFetching:s}=ke({dateStart:t.dateStart,dateEnd:t.dateEnd}),[a]=vn(),d=b=>{Rr.show({content:"Вы действительно хотите удалить запись в дневнике?",closeOnAction:!0,actions:[[{key:"cancel",text:"Нет"},{key:"delete",text:"Удалить",danger:!0,bold:!0,onClick:()=>h(b)}]]})},h=async b=>{try{await a(b.id).unwrap()}catch(f){console.error(f)}};return s?y.jsx(et,{}):o?y.jsx(ie,{status:"default",description:JSON.stringify(o)}):(v=r==null?void 0:r.entries)!=null&&v.length?y.jsx(z,{className:oo.diaryList,children:r.entries.map(b=>y.jsx(Wr,{rightActions:[{key:"delete",text:"Удалить",color:"danger",onClick:()=>d(b)}],children:y.jsx(z.Item,{description:Se(b.calories,b.weight),extra:M(b.date).format("HH:mm"),onClick:()=>e(b),children:Oe(b.product)})},b.id))}):y.jsx(ie,{image:Vt,title:"Дневник пуст",description:""})},lo="_productList_8retd_1",co={productList:lo},uo="https://world.openfoodfacts.org",fo=gn.injectEndpoints({endpoints:n=>({getFoods:n.infiniteQuery({infiniteQueryOptions:{initialPageParam:{page:1,size:20},getNextPageParam:(e,t,r)=>{if(!(e.page_size*e.page>=e.count))return{...r,page:r.page+1}}},query:({queryArg:e,pageParam:t})=>({url:`${uo}/cgi/search.pl`,params:{fields:["id","product_name","brands","nutriments.proteins_100g","nutriments.fat_100g","nutriments.carbohydrates_100g","nutriments.energy-kcal_100g"].join(","),search_terms:e.search,page:t.page,page_size:t.size,json:1}}),transformResponse:e=>{var t;return{...e,products:(t=e==null?void 0:e.products)==null?void 0:t.map(r=>{var o,s,a,d;return{id:r.id,product_name:r.product_name??"",brands:r.brands??"",nutriments:{proteins_100g:((o=r.nutriments)==null?void 0:o.proteins_100g)??null,fat_100g:((s=r.nutriments)==null?void 0:s.fat_100g)??null,carbohydrates_100g:((a=r.nutriments)==null?void 0:a.carbohydrates_100g)??null,"energy-kcal_100g":((d=r.nutriments)==null?void 0:d["energy-kcal_100g"])??null}}})}}})})}),{useGetFoodsInfiniteQuery:mo}=fo,ho=n=>{var a;const{onChange:e}=n,{data:t,error:r,isFetching:o}=pn(),s=d=>{e==null||e(d.product,d.weight)};return o?y.jsx(et,{}):r?y.jsx(ie,{status:"default",description:JSON.stringify(r)}):(a=t==null?void 0:t.entries)!=null&&a.length?y.jsx(z,{className:co.productList,children:t.entries.map(d=>y.jsx(z.Item,{description:Se(d.calories,d.weight),onClick:()=>s(d),children:Oe(d.product)},d.id))}):y.jsx(ie,{status:"busy",title:"Недавних продуктов нет",description:""})},vo="_productList_2dsts_1",go={productList:vo},po=n=>{const{onChange:e}=n,[t,r]=p.useState(""),{data:o,error:s,isFetching:a,isFetchingNextPage:d,hasNextPage:h,fetchNextPage:v}=mo({search:t},{skip:!t}),b=p.useMemo(()=>{var m;return((m=o==null?void 0:o.pages)==null?void 0:m.reduce((g,O)=>(g=g.concat(O.products??[]),g),[]))??[]},[o]),f=p.useCallback(m=>{e==null||e(m)},[e]),_=async()=>{if(d)return Promise.resolve();await v()};return y.jsxs(q,{direction:"column",fullHeight:!0,gap:16,children:[y.jsx(Ar,{placeholder:"Поиск продуктов",autoFocus:!0,onSearch:r,onClear:()=>r("")}),a&&!d?y.jsx(et,{}):s?y.jsx(ie,{status:"default",description:JSON.stringify(s)}):!t||!b.length?y.jsx(ie,{image:Vt,title:"Выполните поиск",description:""}):y.jsxs(z,{className:go.productList,children:[b.map(m=>{var g;return y.jsx(z.Item,{description:Se((g=m.nutriments)==null?void 0:g["energy-kcal_100g"]),onClick:()=>f(m),children:Oe(m)},m.id)}),y.jsx(Dr,{hasMore:h,loadMore:_})]},t)]})},yo="_formField_17k90_1",bo="_tabsContainer_17k90_19",$t={formField:yo,tabsContainer:bo},_o=n=>{var h;const{value:e,openOnInit:t,onChange:r,onChangeWeight:o}=n,[s,a]=p.useState(!1),d=(v,b)=>{r==null||r(v),o==null||o(b),a(!1)};return p.useEffect(()=>{t&&a(!0)},[]),y.jsxs(y.Fragment,{children:[y.jsx(z,{className:$t.formField,children:y.jsx(z.Item,{description:Se((h=e==null?void 0:e.nutriments)==null?void 0:h["energy-kcal_100g"]),onClick:()=>{a(!0)},children:e?Oe(e):"Выбрать продукт"})}),y.jsx(Ke,{visible:s,destroyOnClose:!0,onMaskClick:()=>a(!1),onClose:()=>a(!1),children:y.jsxs(ze,{className:$t.tabsContainer,children:[y.jsx(ze.Tab,{title:"Недавние",destroyOnClose:!0,children:y.jsx(ho,{onChange:d})},"productLatest"),y.jsx(ze.Tab,{title:"Поиск",destroyOnClose:!0,children:y.jsx(po,{onChange:d})},"productSearch")]})})]})},Co=n=>{const{value:e,onChange:t}=n,r=de(fe),[o]=H.useForm(),[s,a]=p.useState(""),[d,{isLoading:h}]=yn(),[v,{isLoading:b}]=bn(),f=p.useCallback(()=>{const k=e?{...e,weight:String(e.weight),date:e.date?new Date(e.date):void 0}:{id:void 0,product:void 0,weight:"",calories:void 0,date:M(r.dateStart).startOf("day").toDate()};o.setFieldsValue(k)},[e,o,r]),_=async()=>{var k;try{const C=o.getFieldsValue(!0),x=M(),i={id:C==null?void 0:C.id,product:C.product,weight:Number(C.weight),calories:C.calories,date:C!=null&&C.id?(k=C.date)==null?void 0:k.toISOString():M(C.date).set("hour",x.hour()).set("minute",x.minute()).set("second",x.second()).set("millisecond",x.millisecond()).toISOString()};await(i.id?v:d)(i).unwrap(),f(),t()}catch(C){console.error(C)}},m=k=>{o.setFieldValue("weight",k??"")},g=()=>{a(o.getFieldValue("weight")),m(void 0)},O=()=>{!o.getFieldValue("weight")&&s&&m(Number(s))};return p.useEffect(()=>{f()},[f]),y.jsxs(H,{form:o,footer:y.jsx(Ir,{block:!0,direction:"vertical",style:{"--gap":"16px"},children:y.jsx(se,{block:!0,type:"submit",color:"primary",size:"large",disabled:h||b,loading:h||b,children:"Сохранить"})}),onFinish:_,children:[y.jsx(H.Header,{children:e!=null&&e.id?"Обновить запись в дневнике":"Добавить в дневник"}),y.jsx(H.Item,{name:"product",label:"Продукт",rules:[{required:!0}],children:y.jsx(_o,{openOnInit:!(e!=null&&e.id),onChangeWeight:m})}),y.jsx(H.Item,{name:"weight",label:"Вес",rules:[{required:!0}],children:y.jsx(Ge,{placeholder:"В граммах",type:"number",onClick:g,onBlur:O})}),y.jsx(H.Subscribe,{to:["weight","product"],children:({weight:k,product:C},x)=>{var l;const i=Qr(Number(k),(l=C==null?void 0:C.nutriments)==null?void 0:l["energy-kcal_100g"]);return x.setFieldValue("calories",i>0?i:0),y.jsx(H.Item,{label:"Всего калорий",children:y.jsx(Ge,{value:x.getFieldValue("calories"),readOnly:!0})})}})]})},Eo=n=>{const{isOpen:e,value:t,onClose:r}=n,o=()=>{r()};return y.jsx(Ke,{visible:e,destroyOnClose:!0,onMaskClick:r,children:y.jsx(Co,{value:t,onChange:o})})},wo="_trigger_g51zl_1",xo={trigger:wo},ko="DD.MM.YYYY",So=n=>{const{value:e,onChange:t}=n,[r,o]=p.useState(!1),s=p.useMemo(()=>e?M(e).format(ko):"Выберите дату",[e]),a=p.useMemo(()=>{if(!e)return;const f=M(e);return f.set("month",f.get("month")-1).startOf("month").toDate()},[e]),d=p.useMemo(()=>{if(!e)return;const f=M(e);return f.set("month",f.get("month")+1).endOf("month").toDate()},[e]),h=p.useCallback(()=>o(!0),[]),v=p.useCallback(()=>o(!1),[]),b=p.useCallback(f=>{t==null||t(f),o(!1)},[t]);return y.jsxs(y.Fragment,{children:[y.jsxs(q,{direction:"row",align:"center",gap:8,onClick:h,className:xo.trigger,children:[y.jsx("span",{children:s}),y.jsx(Un,{fontSize:12})]}),y.jsx(mr,{weekStartsOn:"Monday",selectionMode:"single",confirmText:"Закрыть",popupBodyStyle:{paddingBottom:"env(safe-area-inset-bottom)"},visible:r,value:e,min:a,max:d,onClose:v,onMaskClick:v,onChange:b})]})},Oo=()=>{const n=Wt(),[e,t]=p.useState(!1),[r,o]=p.useState(),s=de(fe),{isFetching:a}=ke({dateStart:s.dateStart,dateEnd:s.dateEnd}),d=p.useMemo(()=>({...s,date:new Date(s.dateStart)}),[s]),h=p.useCallback(()=>{t(!0)},[]),v=p.useCallback(()=>{t(!1),o(void 0)},[]),b=_=>{o(_),h()},f=_=>{const m={dateStart:_.date.toISOString(),dateEnd:_.date.toISOString()};n(qt(m))};return y.jsxs(q,{className:Nt.content,gap:16,fullWidth:!0,children:[a?y.jsx(eo,{}):y.jsxs(q,{direction:"row",align:"center",justify:"space-between",children:[y.jsx(H,{className:Nt.filterForm,initialValues:d,onValuesChange:f,children:y.jsx(H.Item,{name:"date",noStyle:!0,children:y.jsx(So,{})})}),y.jsx(se,{color:"primary",onClick:()=>h(),children:"Добавить"})]}),y.jsx(ao,{onClickItem:b}),y.jsx(Eo,{isOpen:e,value:r,onClose:v})]})},Mo=p.memo(()=>{const n=Wt(),e=de(fe),{refetch:t}=ke({dateStart:e.dateStart,dateEnd:e.dateEnd});return p.useLayoutEffect(()=>{const r={dateStart:M().toISOString(),dateEnd:M().toISOString()};n(qt(r))},[n]),y.jsx(Cn,{onRefresh:()=>t(),children:y.jsxs(q,{align:"center",children:[y.jsx(Kr,{}),y.jsx(Oo,{})]})})});export{Mo as default};
